# Система управления мобильными роботами

Система управления мобильными роботами на прямоугольной сетке поддерживает динамическое перестроения маршрута и распределение задач ближайшим свободными роботам. 

## Основные особенности

### Алгоритм работы системы:
Каждый такт
- взять n задач ( min(количество роботов и задач) ), если есть кому выдать
- найти для каждой первой активной ячейки в задаче ближайшего робота (использован алгоритм поиска в ширину с прекращением при обнаружении первого свободного робота)
- "забронировать" его
- каждый робот осуществляет шаг в соответствии с:
	- построенным по алгоритму поска в ширину маршруту
	- если есть препятствие, то перестраивает маршрут
	- если некуда идти / следующая ячейка - цель, то ждет
	- он может потратить такт на ожидание в ячейке

### Рассмотренные тесты и крайвые случаи (номер в списке = номер в названии файла в директории тестов):
1) Роботов больше, чем задач
2) Количество роботов и задач одинаково
3) Задач больше, чем роботов
4) Случайно сгенерированный с помощью ИИ тест выполняется корректно
5) 4 активных ячейки по углам (роботы должны ходить в диаметрально противоположные углы при выполнении задания)
6) Минимальный размер поля: 2х2
7) Около минимальный размер поля: 3х3
8) Робот находится в активной ячейке при инициализации системы
9) Все стороны являются активными ячейками для поля 5х5
10) Все стороны являются активными ячейками для поля 10х10
11) Нагрузочный тест с замером времени выполнения программы (поле 50х50, 10 активных ячеек, задач и 10 роботов - более массивную систему мой компьютер не успел посчитать)

### Рассмотренные краевые случаи:
- Робот не может идти по маршруту, потому что по пути другой робот - перестраивает маршрут
- Робот должен идти в вторую активную ячейку задания, но там находится другой робот и выполняет свое задание - все равно идет к ячейке и ждет у нее, если она еще занята
- Робот закончил задание и мешает другому попасть в ячейку - отходит так, чтобы не оставаться в активной ячейке
- Робот не может двинуться, потому что заблокирован свободными роботами - система делает "achtung" и заставляет всех свободных роботов сделать шаг к центру, если это возможно

### Возможные улучшения системы, на которые не хватило времени:
- Deadlock роботов: они получили задания 1-2 и 2-1, а ячейки 1 и 2 находятся рядом - текущяя реакция системы: бесконечное ожидание каждого из роботов - возможный фикс: при таком ожидании более максимального времени ожинания роботов в системе в активной ячейке двигать всех роботов, которые хотят выполнить втрую часть задания к центру и перепрокладывать маршрут
- Когда в углу находится точка назначенного задания, но подход к ней заблокирован другими роботами - стоящими в соседних свободных ячейках или освободившимися
- Поменять не оччень эффективный алгоритм поиска BFS на А* для построения маршрута для робота

## Как настроить систему 

Проект собирается с помощью Cmake
#### 1) Начальные требования
##### Ubuntu
```
sudo apt install git gcc g++ cmake
```
##### Fedora
```
sudo dnf install git gcc gcc-c++ cmake
```

#### 2) Скачайте исходный код
```
git clone https://github.com/Natalia459/task_trainee_2025.git
cd task_trainee_2025
```

#### 3) Настройте систему
```
mkdir build
cd build
cmake ..
make
```

Начальные настройки системы задаются через файл конфигурации: config.json или из командной строки при запуске с командой "cmd". Пример:

```json
{
	"field_size": [5, 10],
	"robot_settings": {
		"amount": 1,
		"coordinates": [
			[1, 4]
		],
		"a_wait_time": [
			2
		],
		"b_wait_time": [
			3
		]
	},
	"active_cells_settings": {
		"1": [0, 0]
	},
	"task_file_name": "task.txt",
	"log_file_name": "log.txt"
}
```
Для тестирования функциональности есть тестировочные настройки системы в директории tests: в configs - json-файлы с начальными настройками, а в tasks - задачи. Также в logs приложены соответствующие выводы системы. 
Для вывода состояния системы используется файл log.txt, если он не будет найден, то вывод пойдет в терминал.
#### 4) Запустите
В ./task_trainee_2025/build:
```
./system_for_robots
```

## Структура репозитория

```plaintext
/build                # сборка проекта
/field                # классы поля и ячеек для системы
/input_system         # классы для чтения и парсинга json
                      # и для инициализации системы
/log_system           # класс для логирования 
/robot                # класс для робота
/system               # классы для системы управления роботами и 
                      # построения маршрутов
/tests                # тесты
	/configs          # начальные настройки системы
	/logs             # вывод для соответствующих тестов
	/tasks            # списки задач
```
